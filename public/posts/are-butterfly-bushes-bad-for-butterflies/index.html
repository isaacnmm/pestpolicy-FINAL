<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
 
<title>Are Butterfly Bushes Bad for Butterflies | Pest Policy</title>
<meta name="keywords" content="
   guides, are, butterfly">


<meta name="description" content="The common butterfly bush, *Buddleja davidii*, is a popular garden shrub renowned for its abundant, fragrant flowers that undeniably attract a multitude of...">

<meta name="author" content="Isaac">
<link rel="canonical" href="http://localhost:1313/posts/are-butterfly-bushes-bad-for-butterflies/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.24117e94f7185554bf370e131546657a05d72834bf02c67c2a4215d5cf110a80.css" integrity="sha256-JBF&#43;lPcYVVS/Nw4TFUZlegXXKDS/AsZ8KkIV1c8RCoA=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/are-butterfly-bushes-bad-for-butterflies/">

 
<meta name="twitter:title" content="Are Butterfly Bushes Bad for Butterflies | Pest Policy" />


<meta name="twitter:description" content="The common butterfly bush, *Buddleja davidii*, is a popular garden shrub renowned for its abundant, fragrant flowers that undeniably attract a multitude of..." />
<meta property="og:title" content="Are Butterfly Bushes Bad for Butterflies | Pest Policy" />
<meta property="og:description" content="The common butterfly bush, *Buddleja davidii*, is a popular garden shrub renowned for its abundant, fragrant flowers that undeniably attract a multitude of..." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/are-butterfly-bushes-bad-for-butterflies/" />
<meta property="article:section" content="posts" />
  <meta property="article:published_time" content="2025-07-10T00:00:00&#43;00:00" />
  <meta property="article:modified_time" content="2025-07-10T00:00:00&#43;03:00" />


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Are Butterfly Bushes Bad for Butterflies",
      "item": "http://localhost:1313/posts/are-butterfly-bushes-bad-for-butterflies/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Are Butterfly Bushes Bad for Butterflies | Pest Policy",
  "name": "Are Butterfly Bushes Bad for Butterflies",
  "description": "The common butterfly bush, *Buddleja davidii*, is a popular garden shrub renowned for its abundant, fragrant flowers that undeniably attract a multitude of...",
  "keywords": [
    "guides", "are", "butterfly"
  ],
  "wordCount" : "1400",
  "inLanguage": "en",
  "datePublished": "2025-07-10T00:00:00Z",
  "dateModified": "2025-07-10T00:00:00+03:00",
  "author":{
    "@type": "Person",
    "name": "Isaac"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/are-butterfly-bushes-bad-for-butterflies/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Pest Policy",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script><style>
  #icons {
    display: flex;
    flex-wrap: wrap;
    margin-top: 2em;
  }
  #icons .item {
    width: 80px;
    height: 50px;
    margin: 10px;
  }
  #icons .item .name {
    font-size: 12px;
    user-select: all;
    text-align: center;
  }
  #icons .item .icon {
    display: flex;
    justify-content: center;
  }
  #icons .item svg {
    width: 30px;
    height: 30px;
  }
</style>


<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
   
</noscript>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7369419631229178"
     crossorigin="anonymous"></script>
</head>

<body class=" type-posts kind-page layout-post" id="top"><script data-no-instant>
function switchTheme(theme) {
  switch (theme) {
    case 'light':
      document.body.classList.remove('dark');
      break;
    case 'dark':
      document.body.classList.add('dark');
      break;
    
    default:
      if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
      }
  }
}

function isDarkTheme() {
  return document.body.className.includes("dark");
}

function getPrefTheme() {
  return localStorage.getItem("pref-theme");
}

function setPrefTheme(theme) {
  switchTheme(theme)
  localStorage.setItem("pref-theme", theme);
}

const toggleThemeCallbacks = {}
toggleThemeCallbacks['main'] = (isDark) => {
  
  if (isDark) {
    setPrefTheme('light');
  } else {
    setPrefTheme('dark');
  }
}




window.addEventListener('toggle-theme', function() {
  
  const isDark = isDarkTheme()
  for (const key in toggleThemeCallbacks) {
    toggleThemeCallbacks[key](isDark)
  }
});


function toggleThemeListener() {
  
  window.dispatchEvent(new CustomEvent('toggle-theme'));
}

</script>
<script>
  
  (function() {
    const defaultTheme = 'light';
    const prefTheme = getPrefTheme();
    const theme = prefTheme ? prefTheme : defaultTheme;

    switchTheme(theme);
  })();
</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Pest Policy (Alt + H)">Pest Policy</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/posts/" title="Blog" class="active"
                >Blog
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/contact/" title="Contact"
                >Contact
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main post">

<article class="post-single">
  <header class="post-header">
    <h1 class="post-title">Are Butterfly Bushes Bad for Butterflies</h1>
    <div class="post-description">The common butterfly bush, *Buddleja davidii*, is a popular garden shrub renowned for its abundant, fragrant flowers that undeniably attract a multitude of...</div>
    <div class="post-meta"><span class="meta-item">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select: text;"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select: text;"></rect><line x1="16" y1="2" x2="16" y2="6" style="user-select: text;"></line><line x1="8" y1="2" x2="8" y2="6" style="user-select: text;"></line><line x1="3" y1="10" x2="21" y2="10" style="user-select: text;"></line></svg>
  <span>July 10, 2025</span></span><span class="meta-item">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon" style="user-select: text;"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z" style="user-select: text;"></path><line x1="7" y1="7" x2="7" y2="7" style="user-select: text;"></line></svg>
  <span class="post-tags"><a href="http://localhost:1313/tags/guides/">Guides</a><a href="http://localhost:1313/tags/are/">Are</a><a href="http://localhost:1313/tags/butterfly/">Butterfly</a></span></span>

      
      
    </div>
  </header> 
  <div class="post-content"><p>The common butterfly bush, <em>Buddleja davidii</em>, is a popular garden shrub renowned for its abundant, fragrant flowers that undeniably attract a multitude of butterflies. Its vibrant blooms, often in shades of purple, pink, and white, seem to promise a haven for these delicate pollinators, making it a staple in many pollinator gardens. However, beneath this seemingly beneficial facade lies a complex ecological issue that has led many environmentalists and even some butterfly enthusiasts to question: <strong><a href="/posts/are-pre-emergent-weed-preventers-safe-around-bulbs/">Are</a> butterfly bushes actually bad for butterflies?</strong></p>
<p>The answer, like many things in ecology, isn&rsquo;t a simple yes or no. While butterfly bushes do provide nectar, their non-native, invasive tendencies and lack of support for the complete butterfly life cycle raise significant concerns. Understanding these nuances is crucial for gardeners aiming to create truly beneficial and sustainable pollinator habitats. This article will delve into the pros and cons of <em>Buddleja davidii</em>, discuss its ecological impact, and offer more beneficial alternatives for supporting butterfly populations.</p>
<h2 id="what-is-a-butterfly-bush">What Is a Butterfly Bush?<a hidden class="anchor" aria-hidden="true" href="#what-is-a-butterfly-bush">¶</a></h2>
<p>The term &ldquo;butterfly bush&rdquo; most commonly refers to <em>Buddleja davidii</em>, also known as Summer Lilac. It is a fast-growing, deciduous to semi-evergreen shrub native to China. Its popularity stems from:</p>
<ul>
<li><strong>Abundant Flowers:</strong> Produces dense, cone-shaped flower clusters (panicles) from summer into fall.</li>
<li><strong>Strong Nectar Source:</strong> The flowers produce copious amounts of nectar, which is highly attractive to a wide range of pollinators, particularly butterflies, but also bees and hummingbirds.</li>
<li><strong>Ease of Growth:</strong> <em>Buddleja davidii</em> is relatively drought-tolerant, adaptable to various soil types, and generally low-maintenance, making it a popular choice for gardeners.</li>
</ul>
<h2 id="negative-impacts-of-butterfly-bushes">Negative Impacts of Butterfly Bushes<a hidden class="anchor" aria-hidden="true" href="#negative-impacts-of-butterfly-bushes">¶</a></h2>
<p>Despite their allure to adult butterflies, <em>Buddleja davidii</em> poses several ecological problems:</p>
<ol>
<li><strong>Invasiveness:</strong> This is the primary concern. <em>Buddleja davidii</em> is a prolific seed producer, and its seeds are easily dispersed by wind and water. It readily colonizes disturbed areas, roadsides, riparian zones (along waterways), and open woodlands.
<ul>
<li><strong>Ecological Disruption:</strong> Once established, it can outcompete and displace native vegetation, reducing biodiversity and altering natural habitats. In many regions, it is classified as an invasive species (e.g., in the Pacific Northwest, parts of Europe, and areas with suitable climates globally).</li>
<li><strong>Lack of Native Support:</strong> By displacing native plants, it reduces the availability of essential host plants that insect larvae (caterpillars) need to feed on.</li>
</ul>
</li>
<li><strong>&ldquo;Pollinator Traps&rdquo;:</strong> While butterfly bushes provide nectar, they are often described as &ldquo;pollinator traps.&rdquo;
<ul>
<li><strong>Nectar Only, No Larval Host:</strong> <em>Buddleja davidii</em> provides nectar for adult butterflies but <strong>does not serve as a host plant for any North American or European butterfly or moth species</strong>. This means no butterfly caterpillar can feed on its leaves.</li>
<li><strong>Nutritional Deficiency:</strong> The nectar, while plentiful, may not be nutritionally complete for all pollinators compared to nectar from native plants. Some research suggests it can contain compounds that may even have negative effects on certain insect species, though more research is needed here.</li>
<li><strong>Diverting Pollinators:</strong> The sheer abundance of <em>Buddleja</em> flowers can draw pollinators away from native plants that <em>do</em> serve as host plants, potentially reducing the reproductive success of those native plant communities and the insects that rely on them.</li>
</ul>
</li>
</ol>
<h2 id="how-butterfly-bushes-reproduce">How Butterfly Bushes Reproduce<a hidden class="anchor" aria-hidden="true" href="#how-butterfly-bushes-reproduce">¶</a></h2>
<p><em>Buddleja davidii</em> primarily reproduces through <strong>seeds</strong>.</p>
<ul>
<li><strong>Seed Production:</strong> Each flower spike can produce thousands of tiny, wind-dispersed seeds. These seeds have a high germination rate.</li>
<li><strong>Self-Seeding:</strong> The plant readily self-seeds, leading to new plants popping up in unexpected places, including cracks in pavement, disturbed soil, and natural areas.</li>
<li><strong>Vegetative Reproduction:</strong> While less common than seed dispersal, butterfly bushes can also root from stem fragments, especially in moist conditions.</li>
</ul>
<p>The prolific seed production and rapid establishment are key factors contributing to its invasive nature.</p>
<h2 id="are-butterfly-bushes-bad-for-butterflies">Are Butterfly Bushes Bad for Butterflies?<a hidden class="anchor" aria-hidden="true" href="#are-butterfly-bushes-bad-for-butterflies">¶</a></h2>
<p>In short, <strong>yes, if they become invasive and displace native plants.</strong></p>
<ul>
<li><strong>The Problem is Indirect:</strong> The butterfly bush isn&rsquo;t directly toxic to adult butterflies. They do feed on its nectar. The harm comes from its ecological behavior.</li>
<li><strong>Disrupting the Life Cycle:</strong> Butterflies have a complete metamorphosis: egg, larva (caterpillar), pupa, and adult. Each stage has specific needs. Adult butterflies need nectar for energy, but their caterpillars need very specific <strong>host plants</strong> to eat. If <em>Buddleja davidii</em> outcompetes native plants, it reduces the available host plants, meaning adult butterflies have fewer places to lay eggs and fewer food sources for their offspring. This leads to a decline in butterfly populations over time.</li>
<li><strong>Example:</strong> A Monarch butterfly needs milkweed (<em>Asclepias spp.</em>) as a host plant for its caterpillars. If butterfly bush displaces milkweed, there will be fewer Monarchs, regardless of how much nectar the butterfly bush provides for the adults.</li>
</ul>
<p>Therefore, while <em>Buddleja davidii</em> is superficially attractive to butterflies, it ultimately contributes to habitat degradation and a less robust ecosystem that can support the full butterfly life cycle.</p>
<h2 id="prevent-butterfly-bushes-from-invading-other-plants">Prevent Butterfly Bushes from Invading Other Plants<a hidden class="anchor" aria-hidden="true" href="#prevent-butterfly-bushes-from-invading-other-plants">¶</a></h2>
<p>If you already have <em>Buddleja davidii</em> in your garden and are committed to keeping it, you can take steps to minimize its invasive spread:</p>
<ol>
<li><strong>Deadheading (Crucial):</strong> <strong>Aggressively deadhead</strong> spent flower spikes <em>before</em> they go to seed. This is the most important step to prevent seed dispersal. Deadhead continually throughout the blooming season.</li>
<li><strong>Choose Sterile or Low-Viability Cultivars:</strong> Many nurseries now offer sterile or low-seed-producing <em>Buddleja</em> cultivars (e.g., those in the &lsquo;Lo &amp; Behold&rsquo; series, &lsquo;Blue Chip&rsquo;, &lsquo;Miss Molly&rsquo;, &lsquo;Pink Micro Chip&rsquo;). These are a much better choice if you want a butterfly bush. Always check the plant tag for information on seed viability.</li>
<li><strong>Containment:</strong> Plant in areas where its spread can be easily monitored and controlled, away from natural areas.</li>
<li><strong>Monitor and Remove Volunteers:</strong> Regularly check your garden and surrounding areas for any self-seeded seedlings and remove them promptly.</li>
</ol>
<h2 id="alternatives-to-butterfly-bushes">Alternatives To Butterfly Bushes<a hidden class="anchor" aria-hidden="true" href="#alternatives-to-butterfly-bushes">¶</a></h2>
<p>Replacing <em>Buddleja davidii</em> with native plants is the best way to support local butterfly populations and overall ecosystem health. Here are categories of plants that provide both nectar for adults and host plants for caterpillars:</p>
<ol>
<li>
<p><strong>Native Nectar Sources (for adult butterflies):</strong></p>
<ul>
<li><strong>Coneflower (<em>Echinacea spp.</em>):</strong> Various colors, long bloom time.</li>
<li><strong>Bee Balm (<em>Monarda spp.</em>):</strong> Nectar and unique flower forms.</li>
<li><strong>Blazing Star (<em>Liatris spp.</em>):</strong> Tall, striking purple spikes.</li>
<li><strong>Goldenrod (<em>Solidago spp.</em>):</strong> Important late-season nectar.</li>
<li><strong>Milkweeds (<em>Asclepias spp.</em>):</strong> Crucial for Monarchs.</li>
<li><strong>Phlox (<em>Phlox spp.</em>):</strong> Fragrant and colorful.</li>
<li><strong>Zinnias:</strong> While often hybrids, single-petal varieties are great nectar sources and not invasive.</li>
<li><strong>Lantana (Native varieties where applicable):</strong> Some native species are good nectar sources.</li>
</ul>
</li>
<li>
<p><strong>Native Host Plants (for caterpillars):</strong></p>
<ul>
<li><strong>Milkweeds (<em>Asclepias spp.</em>):</strong> Host for Monarchs.</li>
<li><strong>Pipevine (<em>Aristolochia spp.</em>):</strong> Host for Pipevine Swallowtails.</li>
<li><strong>Fennel, Dill, Parsley (<em>Apiaceae</em> family):</strong> Host for Black Swallowtails.</li>
<li><strong>Willow (<em>Salix spp.</em>):</strong> Host for Viceroy, Mourning Cloak, and many moths.</li>
<li><strong>Oak (<em>Quercus spp.</em>):</strong> Host for hundreds of moth and butterfly species.</li>
<li><strong>Native Violets (<em>Viola spp.</em>):</strong> Host for Fritillaries.</li>
<li><strong>Spicebush (<em>Lindera benzoin</em>):</strong> Host for Spicebush Swallowtail.</li>
<li><strong>Pawpaw (<em>Asimina triloba</em>):</strong> Host for Zebra Swallowtail.</li>
<li><strong>Redbud (<em>Cercis canadensis</em>):</strong> Host for Henry&rsquo;s Elfin.</li>
</ul>
</li>
</ol>
<p>When choosing alternatives, focus on <strong>native plants specific to your region</strong>. These plants have co-evolved with local insect populations and provide the most complete ecological support.</p>
<h2 id="consider-succession-planting">Consider Succession Planting<a hidden class="anchor" aria-hidden="true" href="#consider-succession-planting">¶</a></h2>
<p>To create a truly thriving butterfly garden, think beyond just individual plants. Implement <strong>succession planting</strong> to ensure there are continuous blooms and host plants available throughout the growing season.</p>
<ul>
<li><strong>Early Spring Nectar:</strong> Provide flowers that bloom as adult butterflies emerge from overwintering.</li>
<li><strong>Mid-Summer Nectar &amp; Hosts:</strong> Ensure a peak of food and breeding sites during the most active period.</li>
<li><strong>Late Season Nectar:</strong> Offer critical nectar sources for migrating butterflies (like Monarchs) and those preparing for winter.</li>
</ul>
<p>A diverse garden with different bloom times, flower shapes, and a mix of nectar and host plants will create a far more robust and resilient ecosystem for butterflies and all pollinators than any single plant, native or non-native.</p>
<h2 id="final-thoughts-on-butterfly-bushes">Final Thoughts on Butterfly Bushes<a hidden class="anchor" aria-hidden="true" href="#final-thoughts-on-butterfly-bushes">¶</a></h2>
<p>While the common butterfly bush (<em>Buddleja davidii</em>) is undeniably attractive to adult butterflies, its invasive tendencies and inability to support the larval stage of most butterflies make it a problematic choice for ecologically conscious gardeners. For true butterfly conservation, the focus should shift from simply attracting adults to creating comprehensive habitats that support the entire butterfly life cycle.</p>
<p>By choosing native plants that provide both essential nectar for adult butterflies and specific host plants for their caterpillars, and by implementing responsible gardening practices like succession planting and invasive species management, gardeners can cultivate landscapes that are genuinely beneficial for pollinators and contribute to a healthier, more biodiverse environment. Opt for sterile varieties if you must grow <em>Buddleja</em>, but ideally, fill your garden with the vibrant, life-sustaining native flora that truly sustains our cherished butterflies from egg to adult.</p>


  </div>

  <footer class="post-footer">
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/are-blue-tailed-lizards-poisonous/">
    <span class="title">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left" style="user-select: text;"><line x1="19" y1="12" x2="5" y2="12" style="user-select: text;"></line><polyline points="12 19 5 12 12 5" style="user-select: text;"></polyline></svg>&nbsp;Prev Page</span>
    <br>
    <span>Are Blue Tailed Lizards Poisonous</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/are-crickets-decomposers/">
    <span class="title">Next Page&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right" style="user-select: text;"><line x1="5" y1="12" x2="19" y2="12" style="user-select: text;"></line><polyline points="12 5 19 12 12 19" style="user-select: text;"></polyline></svg>
    </span>
    <br>
    <span>Are Crickets Decomposers</span>
  </a>
</nav>

  </footer>
    <div class="comments-separator"></div>
</article>
    </main>
    
<footer class="footer">
  <span style="display: inline-block; margin-left: 1em; font-size: 18px;">
    We may earn a commission when you click and buy from Amazon.com.
  <span style="display: inline-block; margin-left: 1em;">
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
    <path d="M12 6H0l6-6z" />
  </svg>
</a>

<script>
  (function() {
     
    const disableThemeToggle = '' == '1';
    if (disableThemeToggle) {
      return;
    }

    let button = document.getElementById("theme-toggle")
    
    button.removeEventListener('click', toggleThemeListener)
    
    button.addEventListener('click', toggleThemeListener)
  })();
</script>

<script>
  (function () {
    let menu = document.getElementById('menu')
    if (menu) {
      menu.scrollLeft = localStorage.getItem("menu-scroll-position");
      menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
      }
    }

    const disableSmoothScroll = '' == '1';
    const enableInstantClick = '' == '1';
    
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches || disableSmoothScroll || enableInstantClick) {
      return;
    }
    
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener("click", function (e) {
        e.preventDefault();
        var id = this.getAttribute("href").substr(1);
        document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
          behavior: "smooth"
        });
        if (id === "top") {
          history.replaceState(null, null, " ");
        } else {
          history.pushState(null, null, `#${id}`);
        }
      });
    });
  })();
</script>
<script>
  var mybutton = document.getElementById("top-link");
  window.onscroll = function () {
    if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
      mybutton.style.visibility = "visible";
      mybutton.style.opacity = "1";
    } else {
      mybutton.style.visibility = "hidden";
      mybutton.style.opacity = "0";
    }
  };
</script>
<script>
  if (window.scrollListeners) {
    
    for (const listener of scrollListeners) {
      window.removeEventListener('scroll', listener)
    }
  }
  window.scrollListeners = []
</script>



<script src="/js/medium-zoom.min.js" data-no-instant
></script>




<script>
  
  
  (function() {
    const enableTocScroll = '' == '1'
    if (!enableTocScroll) {
      return
    }
    if (!document.querySelector('.toc')) {
      console.log('no toc found, ignore toc scroll')
      return
    }
    

    
    const scrollListeners = window.scrollListeners
    const headings = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id]');
    const activeClass = 'active';

    
    let activeHeading = headings[0];
    getLinkByHeading(activeHeading).classList.add(activeClass);

    const onScroll = () => {
      const passedHeadings = [];
      for (const h of headings) {
        
        if (getOffsetTop(h) < 5) {
          passedHeadings.push(h)
        } else {
          break;
        }
      }
      if (passedHeadings.length > 0) {
        newActiveHeading = passedHeadings[passedHeadings.length - 1];
      } else {
        newActiveHeading = headings[0];
      }
      if (activeHeading != newActiveHeading) {
        getLinkByHeading(activeHeading).classList.remove(activeClass);
        activeHeading = newActiveHeading;
        getLinkByHeading(activeHeading).classList.add(activeClass);
      }
    }

    let timer = null;
    const scrollListener = () => {
      if (timer !== null) {
        clearTimeout(timer)
      }
      timer = setTimeout(onScroll, 50)
    }
    window.addEventListener('scroll', scrollListener, false);
    scrollListeners.push(scrollListener)

    function getLinkByHeading(heading) {
      const id = encodeURI(heading.getAttribute('id')).toLowerCase();
      return document.querySelector(`.toc ul li a[href="#${id}"]`);
    }

    function getOffsetTop(heading) {
      if (!heading.getClientRects().length) {
        return 0;
      }
      let rect = heading.getBoundingClientRect();
      return rect.top
    }
  })();
  </script>

</body>

</html>
